import{b as Q,r as i,j as e,H as X,L as _,a as w}from"./app-C7rwmfcS.js";import{A as Y}from"./AdminLayout-CyG2N3OH.js";import{F as Z,a as ee}from"./PencilIcon-BshoeJ5U.js";import{F as $}from"./XMarkIcon-DQSo36bu.js";import{F as z}from"./PlusIcon-DZqqzlOP.js";import{F as se}from"./MagnifyingGlassIcon-DbtKTknW.js";import{F as I}from"./TrashIcon-fHHLn2vp.js";import{F as T}from"./PhotoIcon-D6oMPSwm.js";import{F as te}from"./CheckCircleIcon-swMoyRx5.js";import{F as ae}from"./XCircleIcon-DFMENdIW.js";import{F as re}from"./EyeIcon-DDFxnpfp.js";import{F as ie}from"./MapPinIcon-B6SydrzP.js";/* empty css            */import"./Squares2X2Icon-DJChz5O5.js";import"./TicketIcon-CH8U8-AR.js";import"./UserGroupIcon-BFqEtCNI.js";import"./portal-BgFUahiJ.js";import"./transition-Cy0wZH5_.js";import"./ChevronDownIcon-agjRIJMC.js";import"./UserIcon-DFOqjxtt.js";function Se({destinations:d}){const{flash:v}=Q().props,[f,U]=i.useState(""),[c,m]=i.useState([]),[B,x]=i.useState(!1),[j,E]=i.useState(null),[l,o]=i.useState({name:"",description:"",is_active:!0,images:[]}),[A,h]=i.useState([]),[k,g]=i.useState([]),[D,p]=i.useState([]),[y,u]=i.useState([]),[R,N]=i.useState({}),[L,b]=i.useState(!1),M=()=>{E(null),o({name:"",description:"",is_active:!0,images:[]}),h([]),g([]),p([]),u([]),N({}),x(!0)},H=s=>{E(s);let t=[];if(s.images&&Array.isArray(s.images))t=s.images;else if(s.images&&typeof s.images=="string")try{t=JSON.parse(s.images)}catch(r){console.error("Error parsing images:",r)}const a=t.map((r,n)=>({id:n,path:r,url:S(r)}));o({name:s.name||"",description:s.description||"",is_active:s.is_active!==void 0?s.is_active:!0,images:t}),p(a),g([]),h([]),u([]),N({}),x(!0)},S=s=>s?s.startsWith("http")?s:s.startsWith("storage/")?`/${s}`:s.startsWith("/storage")?s:`/storage/${s}`:null,O=s=>{s.preventDefault(),b(!0),N({});const t=new FormData;t.append("name",l.name||""),t.append("description",l.description||""),t.append("is_active",l.is_active?"1":"0"),D.forEach((a,r)=>{y.includes(a.path)||t.append(`images[${r}]`,a.path)}),A.forEach((a,r)=>{t.append(`new_images[${r}]`,a)}),y.forEach((a,r)=>{t.append(`deleted_images[${r}]`,a)}),console.log("FormData contents:");for(let[a,r]of t.entries())console.log(a,r);j?(t.append("_method","PUT"),w.post(route("admin.destinations.update",j.id),t,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{b(!1),x(!1),o({name:"",description:"",is_active:!0,images:[]}),h([]),g([]),p([]),u([])},onError:a=>{console.log("Update errors:",a),N(a),b(!1)}})):w.post(route("admin.destinations.store"),t,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{b(!1),x(!1),o({name:"",description:"",is_active:!0,images:[]}),h([]),g([]),p([]),u([])},onError:a=>{console.log("Create errors:",a),N(a),b(!1)}})},P=s=>{confirm("Are you sure you want to delete this destination? This will also delete all associated packages.")&&w.delete(route("admin.destinations.destroy",s),{preserveScroll:!0})},W=()=>{c.length!==0&&confirm(`Are you sure you want to delete ${c.length} destinations?`)&&(c.forEach(s=>{w.delete(route("admin.destinations.destroy",s),{preserveScroll:!0})}),m([]))},G=s=>{const t=Array.from(s.target.files),a=[],r=[];t.forEach(n=>{if(n.size>2*1024*1024){alert(`${n.name} is too large (max 2MB)`);return}const C=new FileReader;C.onloadend=()=>{a.push({url:C.result,name:n.name}),a.length===t.length&&g(K=>[...K,...a])},C.readAsDataURL(n),r.push(n)}),h(n=>[...n,...r])},J=s=>{const t=[...k],a=[...A];t.splice(s,1),a.splice(s,1),g(t),h(a)},q=s=>{u(t=>[...t,s.path]),p(t=>t.filter(a=>a.path!==s.path))},V=s=>{u(a=>a.filter(r=>r!==s));const t=d.data.find(a=>a.id===j.id)?.images?.find(a=>a===s);t&&p(a=>[...a,{id:a.length,path:t,url:S(t)}])},F=d.data.filter(s=>s.name.toLowerCase().includes(f.toLowerCase())||s.description.toLowerCase().includes(f.toLowerCase()));return e.jsxs(Y,{title:"Destinations",children:[e.jsx(X,{title:"Manage Destinations"}),e.jsxs("div",{className:"space-y-6",children:[v?.success&&e.jsx("div",{className:"rounded-md bg-green-50 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Z,{className:"h-5 w-5 text-green-400"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-green-800",children:v.success})})]})}),v?.error&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx($,{className:"h-5 w-5 text-red-400"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-red-800",children:v.error})})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900"}),e.jsx("p",{className:"mt-1 text-gray-600"})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("button",{onClick:M,className:"inline-flex items-center rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Add Destination"]})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search destinations...",value:f,onChange:s=>U(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})}),c.length>0&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[c.length," selected"]}),e.jsxs("button",{onClick:W,className:"inline-flex items-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white hover:bg-red-500",children:[e.jsx(I,{className:"h-4 w-4 mr-1"}),"Delete Selected"]}),e.jsx("button",{onClick:()=>m([]),className:"text-gray-400 hover:text-gray-600",children:"Clear"})]})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500",onChange:s=>{s.target.checked?m(F.map(t=>t.id)):m([])}})}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Image"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Destination"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Packages"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:F.length>0?F.map(s=>{const t=s.images&&Array.isArray(s.images)?s.images:typeof s.images=="string"?JSON.parse(s.images||"[]"):[];return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("input",{type:"checkbox",checked:c.includes(s.id),onChange:a=>{a.target.checked?m([...c,s.id]):m(c.filter(r=>r!==s.id))},className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"h-12 w-12 rounded-lg overflow-hidden",children:t.length>0?e.jsx("img",{src:S(t[0]),alt:s.name,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center",children:e.jsx(T,{className:"h-6 w-6 text-white"})})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:[t.length," images"]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"max-w-xs",children:e.jsx("p",{className:"text-sm text-gray-900 line-clamp-2",children:s.description})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900",children:s.packages_count||0}),e.jsx("div",{className:"text-xs text-gray-500",children:"packages"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.is_active?e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"h-3 w-3 mr-1"}),"Active"]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"h-3 w-3 mr-1"}),"Inactive"]})})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:new Date(s.created_at).toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(s.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(_,{href:route("packages.index",{destination:s.id}),target:"_blank",className:"text-gray-400 hover:text-gray-600 p-1 rounded hover:bg-gray-100",title:"View Packages",children:e.jsx(re,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>H(s),className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50",title:"Edit",children:e.jsx(ee,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>P(s.id),className:"text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-50",title:"Delete",children:e.jsx(I,{className:"h-5 w-5"})})]})})]},s.id)}):e.jsx("tr",{children:e.jsxs("td",{colSpan:"8",className:"px-6 py-12 text-center text-gray-500",children:[e.jsx("div",{className:"mx-auto h-16 w-16 rounded-full bg-gray-100 flex items-center justify-center",children:e.jsx(ie,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h3",{className:"mt-4 text-xl font-semibold text-gray-900",children:"No destinations found"}),e.jsx("p",{className:"mt-2 text-gray-600",children:f?"No destinations match your search.":"Start by adding your first destination."}),!f&&e.jsx("div",{className:"mt-6",children:e.jsxs("button",{onClick:M,className:"inline-flex items-center rounded-md bg-indigo-600 px-6 py-3 text-base font-semibold text-white shadow-sm hover:bg-indigo-500",children:[e.jsx(z,{className:"h-5 w-5 mr-2"}),"Add Destination"]})})]})})})]})}),d.links.length>3&&e.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:e.jsxs("nav",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-1 flex justify-between sm:hidden",children:d.links.map((s,t)=>e.jsx(_,{href:s.url||"#",className:`relative inline-flex items-center px-4 py-2 text-sm font-medium ${s.active?"z-10 bg-indigo-50 border-indigo-500 text-indigo-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"} ${s.url?"":"opacity-50 cursor-not-allowed"}`,dangerouslySetInnerHTML:{__html:s.label}},t))}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:d.from})," to"," ",e.jsx("span",{className:"font-medium",children:d.to})," of"," ",e.jsx("span",{className:"font-medium",children:d.total})," results"]})}),e.jsx("div",{children:e.jsx("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:d.links.map((s,t)=>e.jsx(_,{href:s.url||"#",className:`relative inline-flex items-center px-4 py-2 text-sm font-medium ${s.active?"z-10 bg-indigo-50 border-indigo-500 text-indigo-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"} ${s.url?"":"opacity-50 cursor-not-allowed"}`,dangerouslySetInnerHTML:{__html:s.label}},t))})})]})]})})]})]}),B&&e.jsx("div",{className:"fixed z-50 inset-0 overflow-y-auto",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:e.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"â€‹"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full sm:p-6 max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"absolute top-0 right-0 pt-4 pr-4",children:e.jsx("button",{onClick:()=>x(!1),className:"text-gray-400 hover:text-gray-500 focus:outline-none",children:e.jsx($,{className:"h-6 w-6"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:j?"Edit Destination":"Create New Destination"}),e.jsxs("form",{onSubmit:O,className:"space-y-6",children:[Object.keys(R).length>0&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Please fix the following errors:"}),e.jsx("div",{className:"mt-2 text-sm text-red-700",children:e.jsx("ul",{className:"list-disc pl-5 space-y-1",children:Object.entries(R).map(([s,t])=>e.jsx("li",{children:Array.isArray(t)?t.join(", "):t},s))})})]})})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Destination Name *"}),e.jsx("input",{type:"text",value:l.name||"",onChange:s=>o({...l,name:s.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),e.jsx("textarea",{value:l.description||"",onChange:s=>o({...l,description:s.target.value}),rows:4,className:"w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",required:!0})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_active",checked:l.is_active||!1,onChange:s=>o({...l,is_active:s.target.checked}),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"is_active",className:"ml-2 block text-sm text-gray-900",children:"Active Destination"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Destination Images (Multiple)"}),D.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Existing Images"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:D.map(s=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:s.url,alt:`Destination ${s.id}`,className:"h-24 w-full object-cover rounded-lg"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 rounded-lg transition-all duration-200 flex items-center justify-center",children:e.jsx("button",{type:"button",onClick:()=>q(s),className:"opacity-0 group-hover:opacity-100 bg-red-600 text-white p-1 rounded-full hover:bg-red-700 transition-all duration-200",children:e.jsx(I,{className:"h-4 w-4"})})})]},s.id))})]}),k.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"New Images"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:k.map((s,t)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:s.url,alt:`New image ${t}`,className:"h-24 w-full object-cover rounded-lg"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 rounded-lg transition-all duration-200 flex items-center justify-center",children:e.jsx("button",{type:"button",onClick:()=>J(t),className:"opacity-0 group-hover:opacity-100 bg-red-600 text-white p-1 rounded-full hover:bg-red-700 transition-all duration-200",children:e.jsx($,{className:"h-4 w-4"})})})]},t))})]}),y.length>0&&e.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:[y.length," image(s) marked for deletion"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:y.map((s,t)=>e.jsx("button",{type:"button",onClick:()=>V(s),className:"inline-flex items-center px-2 py-1 rounded text-xs bg-red-100 text-red-800 hover:bg-red-200",children:"Restore"},t))})]}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-indigo-400 transition-colors duration-200",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("label",{className:"relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500",children:[e.jsx("span",{className:"px-3 py-2 border border-indigo-600 rounded-md hover:bg-indigo-50 transition-colors duration-200",children:"Choose images"}),e.jsx("input",{type:"file",className:"sr-only",onChange:G,accept:"image/*",multiple:!0})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-3",children:"or drag and drop here"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF, WEBP up to 2MB each"})]})})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>x(!1),className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:L,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:L?"Processing...":j?"Update Destination":"Create Destination"})]})]})]})]})})]})}export{Se as default};
