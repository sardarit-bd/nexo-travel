import{u as D,r as o,j as e,H as k,L as h}from"./app-C7rwmfcS.js";import{A as C}from"./AdminLayout-CyG2N3OH.js";import{F as E}from"./ArrowLeftIcon-DT1XUS-l.js";import{F as u}from"./XMarkIcon-DQSo36bu.js";import{F}from"./PhotoIcon-D6oMPSwm.js";/* empty css            */import"./Squares2X2Icon-DJChz5O5.js";import"./TicketIcon-CH8U8-AR.js";import"./UserGroupIcon-BFqEtCNI.js";import"./portal-BgFUahiJ.js";import"./transition-Cy0wZH5_.js";import"./ChevronDownIcon-agjRIJMC.js";import"./UserIcon-DFOqjxtt.js";function q({destination:n}){const p=n.images||[],{data:a,setData:m,processing:g,errors:c,put:j}=D({name:n.name||"",description:n.description||"",is_active:n.is_active??!0,existing_images:p.map(s=>s.path),new_images:[],deleted_images:[]}),[l,f]=o.useState(p),[d,x]=o.useState([]),[v,w]=o.useState(!1);o.useEffect(()=>{const s=a.name!==n.name||a.description!==n.description||a.is_active!==n.is_active||JSON.stringify(a.existing_images)!==JSON.stringify(p.map(t=>t.path))||a.new_images.length>0||a.deleted_images.length>0;w(s)},[a]);const N=s=>{s.preventDefault();const t=new FormData;t.append("name",a.name),t.append("description",a.description),t.append("is_active",a.is_active?"1":"0"),a.existing_images.forEach((i,r)=>{t.append(`images[${r}]`,i)}),a.new_images.forEach((i,r)=>{t.append(`new_images[${r}]`,i)}),a.deleted_images.forEach((i,r)=>{t.append(`deleted_images[${r}]`,i)}),j(route("admin.destinations.update",n.id),t,{forceFormData:!0})},b=s=>{const t=[...s.target.files];m("new_images",[...a.new_images,...t]);const i=t.map(r=>URL.createObjectURL(r));x([...d,...i]),s.target.value=null},_=s=>{const t=l[s];m("deleted_images",[...a.deleted_images,t.path]);const i=[...a.existing_images];i.splice(s,1),m("existing_images",i);const r=[...l];r.splice(s,1),f(r)},y=s=>{URL.revokeObjectURL(d[s]);const t=[...a.new_images],i=[...d];t.splice(s,1),i.splice(s,1),m("new_images",t),x(i)};return e.jsxs(C,{title:"Edit Destination",children:[e.jsx(k,{title:`Edit ${n.name}`}),e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsxs(h,{href:route("admin.destinations.index"),className:"inline-flex items-center text-sm font-medium text-gray-600 hover:text-gray-900",children:[e.jsx(E,{className:"h-4 w-4 mr-1"}),"Back to Destinations"]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-8",children:e.jsxs("form",{onSubmit:N,className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Destination Name *"}),e.jsx("input",{type:"text",value:a.name,onChange:s=>m("name",s.target.value),className:"w-full rounded-md border-gray-300"}),c.name&&e.jsx("p",{className:"text-red-600 text-sm",children:c.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Description *"}),e.jsx("textarea",{rows:"4",value:a.description,onChange:s=>m("description",s.target.value),className:"w-full rounded-md border-gray-300"}),c.description&&e.jsx("p",{className:"text-red-600 text-sm",children:c.description})]}),l.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Current Images"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:l.map((s,t)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:s.url,className:"h-32 w-full object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>_(t),className:"absolute top-2 right-2 bg-red-600 text-white p-1 rounded-full",children:e.jsx(u,{className:"h-4 w-4"})})]},t))})]}),d.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"New Images"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:d.map((s,t)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:s,className:"h-32 w-full object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>y(t),className:"absolute top-2 right-2 bg-red-600 text-white p-1 rounded-full",children:e.jsx(u,{className:"h-4 w-4"})})]},t))})]}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx(F,{className:"h-10 w-10 mx-auto text-gray-400"}),e.jsxs("label",{className:"cursor-pointer inline-block mt-4 px-4 py-2 bg-indigo-600 text-white rounded-md",children:["Upload Images",e.jsx("input",{type:"file",className:"hidden",multiple:!0,accept:"image/*",onChange:b})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4",children:[e.jsx("span",{className:"text-sm",children:"Active"}),e.jsx("input",{type:"checkbox",checked:a.is_active,onChange:s=>m("is_active",s.target.checked)})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[e.jsx(h,{href:route("admin.destinations.index"),className:"px-4 py-2 border rounded-md",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:!v||g,className:"px-6 py-2 bg-indigo-600 text-white rounded-md",children:g?"Updating...":"Update Destination"})]})]})})]})]})}export{q as default};
